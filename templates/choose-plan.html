<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logic and Stories | Choose Plan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Pacifico&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .font-pacifico { font-family: 'Pacifico', cursive; }
        .gradient-text {
            background: linear-gradient(to right, #fde047, #fb923c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .glow-button { box-shadow: 0 0 15px rgba(253, 224, 71, 0.5), 0 0 5px rgba(251, 146, 60, 0.4); }
    </style>
</head>
<body class="bg-slate-900 text-gray-200">
    <header class="bg-slate-900/80 backdrop-blur-sm sticky top-0 z-50 border-b border-slate-800">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="/index.html" class="text-3xl font-pacifico gradient-text pb-1 leading-normal">Logic and Stories</a>
            <a href="/signin.html" class="hover:text-yellow-400 transition-colors cursor-pointer">Sign In</a>
        </nav>
    </header>
    <main class="container mx-auto px-6 py-12">
        <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-bold text-white">Choose Your Plan</h2>
            <p class="text-gray-400 mt-2">Select a plan to continue.</p>
        </div>
        <div class="flex flex-col lg:flex-row justify-center items-center gap-8">
            <div class="w-full lg:w-1/3 bg-slate-800 p-8 rounded-2xl border border-slate-700">
                <h3 class="text-2xl font-bold text-white text-center">Monthly</h3>
                <p class="text-center text-gray-400 mt-2">Perfect for trying things out.</p>
                <p class="text-5xl font-extrabold text-white text-center my-6">$12<span class="text-lg font-medium text-gray-400">/mo</span></p>
                <button data-plan="Monthly" class="select-plan w-full mt-8 block text-center bg-gray-700 text-white font-bold py-3 px-6 rounded-full hover:bg-gray-600 transition-colors">Choose Plan</button>
            </div>
            <div class="w-full lg:w-1/3 bg-slate-800 p-8 rounded-2xl border-2 border-yellow-400 relative transform lg:scale-110">
                <div class="absolute top-0 -translate-y-1/2 left-1/2 -translate-x-1/2">
                    <span class="bg-yellow-400 text-slate-900 text-sm font-bold px-4 py-1 rounded-full">BEST VALUE</span>
                </div>
                <h3 class="text-2xl font-bold text-white text-center">Annual</h3>
                <p class="text-center text-gray-400 mt-2">Save 25% and learn all year.</p>
                <p class="text-5xl font-extrabold text-white text-center my-6">$9<span class="text-lg font-medium text-gray-400">/mo</span></p>
                <button data-plan="Annual" class="select-plan w-full mt-8 block text-center bg-yellow-400 text-slate-900 font-bold py-3 px-6 rounded-full hover:bg-yellow-300 transition-all transform hover:scale-105 glow-button">Start Free Trial</button>
            </div>
            <div class="w-full lg:w-1/3 bg-slate-800 p-8 rounded-2xl border border-slate-700">
                <h3 class="text-2xl font-bold text-white text-center">Family</h3>
                <p class="text-center text-gray-400 mt-2">For the whole adventuring crew.</p>
                <p class="text-5xl font-extrabold text-white text-center my-6">$18<span class="text-lg font-medium text-gray-400">/mo</span></p>
                <button data-plan="Family" class="select-plan w-full mt-8 block text-center bg-gray-700 text-white font-bold py-3 px-6 rounded-full hover:bg-gray-600 transition-colors">Choose Plan</button>
            </div>
        </div>
        <div id="message" class="text-center mt-6 text-red-400"></div>
    </main>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);
        const userId = params.get('userId');
        const buttons = document.querySelectorAll('.select-plan');
        const messageDiv = document.getElementById('message');
        buttons.forEach(btn => {
            btn.addEventListener('click', async () => {
                const plan = btn.dataset.plan;
                messageDiv.textContent = '';
                try {
                    const resp = await fetch('/api/select-plan', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ userId, plan })
                    });
                    const data = await resp.json();
                    if (resp.ok) {
                        window.location.href = '/';
                    } else {
                        messageDiv.textContent = data.message || 'An error occurred.';
                    }
                } catch (err) {
                    messageDiv.textContent = 'Could not connect to the server.';
                }
            });
        });
    });
    </script>
</body>
</html>
